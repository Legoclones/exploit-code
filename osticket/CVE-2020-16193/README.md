# CVE-2020-16193
## Requirements
* Privileged access to the osTicket instance
    * This requires an account with agent status, not a guest or regular account.

## Description
Cross-Site Scripting is achieved by putting a malicious payload inside of the internal notes when banning a user at `http://domain.com/scp/banlist.php`. This requires that you already have an agent account, and can only target other agents since normal users are not authorized to see this page. To reproduce, head to the `/scp/banlist.php` page and either select a pre-existing banned user or ban a user. In the internal notes, paste a generic XSS payload such as `<img src="x" onerror="alert('XSS')">` and save. This will bring you back to the main page; if you put your cursor over the email of the banned account, you can copy and send that malicious link to other agents, who will trigger the payload upon opening.

![](screenshot.png)

## Credits
Based on description found in [the CVE](https://www.cvedetails.com/cve/CVE-2020-16193/) and [GitHub commit](https://github.com/osTicket/osTicket/pull/5616/commits/fb570820ef1138776f929a179906e1d8089179d9), found by heinhtetaung.